<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmileGame</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f0f8ff;
    overflow: hidden;
    user-select: none;
  }
  #game {
    position: relative;
    width: 90vw;
    max-width: 600px;
    height: 90vh;
    max-height: 800px;
    border: 2px solid #333;
    border-radius: 15px;
    background-color: #fff;
    overflow: hidden;
  }
  .star-container {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    color: gold;
  }
  .smile {
    position: absolute;
    font-size: 40px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .smile:active {
    transform: scale(1.2);
  }
  #message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 32px;
    background: rgba(255,255,255,0.9);
    padding: 20px 40px;
    border-radius: 10px;
    display: none;
    text-align: center;
  }
  #message button {
    margin-top: 15px;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
  }

  /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ */
  @media (max-width: 600px) {
    .smile {
      font-size: 30px;
    }
    .star-container {
      font-size: 20px;
    }
    #message {
      font-size: 24px;
      padding: 15px 30px;
    }
    #message button {
      font-size: 16px;
      padding: 8px 16px;
    }
  }

  /* –ï—â—ë –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ */
  @media (max-width: 400px) {
    .smile {
      font-size: 25px;
    }
    .star-container {
      font-size: 18px;
    }
    #message {
      font-size: 20px;
      padding: 12px 25px;
    }
    #message button {
      font-size: 14px;
      padding: 6px 12px;
    }
  }
</style>

</head>
<body>

<div id="game">
  <div class="star-container" id="stars">‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</div>
  <div id="message">
    <div id="message-text"></div>
    <button id="skip-btn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
  </div>
</div>

<script>
const game = document.getElementById('game');
const starsEl = document.getElementById('stars');
const message = document.getElementById('message');
const messageText = document.getElementById('message-text');
const skipBtn = document.getElementById('skip-btn');

let stars = 5;
let level = 1;
let maxLevel = 30;
let smileCount = 1;
let timeLimit = 2000; // 2 —Å–µ–∫—É–Ω–¥—ã
let activeSmiles = [];

function updateStars() {
  starsEl.textContent = '‚≠êÔ∏è'.repeat(stars);
}

function randomPosition(size) {
  const x = Math.random() * (game.clientWidth - size);
  const y = Math.random() * (game.clientHeight - size - 50) + 50; // —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –∑–≤–µ–∑–¥—ã
  return {x, y};
}

function createSmile() {
  const smile = document.createElement('div');
  smile.classList.add('smile');
  smile.textContent = 'üòä';
  const pos = randomPosition(40);
  smile.style.left = pos.x + 'px';
  smile.style.top = pos.y + 'px';
  game.appendChild(smile);

  smile.onclick = () => {
    stars = Math.min(5, stars + 1); // –¥–æ–±–∞–≤–ª—è–µ–º –∑–≤–µ–∑–¥—É, –º–∞–∫—Å–∏–º—É–º 5
    updateStars();
    clearTimeout(smile.timeout);
    game.removeChild(smile);
    activeSmiles = activeSmiles.filter(s => s !== smile);
    checkLevelComplete();
  }

  smile.timeout = setTimeout(() => {
    // –µ—Å–ª–∏ –Ω–µ —É—Å–ø–µ–ª –∫–ª–∏–∫–Ω—É—Ç—å
    if (game.contains(smile)) {
      stars--;
      updateStars();
      game.removeChild(smile);
      activeSmiles = activeSmiles.filter(s => s !== smile);
      checkGameOver();
      checkLevelComplete();
    }
  }, timeLimit);

  activeSmiles.push(smile);
}

function spawnSmiles(count) {
  for (let i = 0; i < count; i++) {
    createSmile();
  }
}

function startLevel() {
  smileCount = level; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–º–∞–π–ª–∏–∫–æ–≤ —Ä–∞–≤–Ω–æ —É—Ä–æ–≤–Ω—é
  timeLimit = 2000 + (level - 1) * 1000; // —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É
  spawnSmiles(smileCount);
}

function checkLevelComplete() {
  if (activeSmiles.length === 0) {
    if (level >= maxLevel) {
      showMessage('–í—ã –ø—Ä–æ—à–ª–∏ –∏–≥—Ä—É! –ü–æ–ª—É—á–∞–µ—Ç–µ 10 –∑–≤–µ–∑–¥ üéâ');
      stars = 10;
      updateStars();
    } else {
      level++;
      startLevel();
    }
  }
}

function checkGameOver() {
  if (stars <= 0) {
    showMessage('–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢');
  }
}

function showMessage(text) {
  messageText.textContent = text;
  message.style.display = 'block';
  if (text.includes('–ø—Ä–æ–∏–≥—Ä–∞–ª–∏')) {
    setTimeout(() => { message.style.display = 'none'; restartGame(); }, 5000);
  }
}

function restartGame() {
  stars = 5;
  level = 1;
  updateStars();
  activeSmiles.forEach(s => game.removeChild(s));
  activeSmiles = [];
  startLevel();
}

skipBtn.onclick = () => {
  message.style.display = 'none';
  if (stars <= 0) {
    restartGame();
  } else if (level >= maxLevel) {
    restartGame();
  }
}

updateStars();
startLevel();

</script>
</body>
</html>

